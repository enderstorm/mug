<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Mug : Developer&#39;s workbench primarily oriented for web apps development supported by Docker and other fancy technologies">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Mug</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/seges/mug">View on GitHub</a>

          <h1 id="project_title">Mug</h1>
          <h2 id="project_tagline">Developer&#39;s workbench primarily oriented for web apps development supported by Docker and other fancy technologies</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/seges/mug/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/seges/mug/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="mug-development-workbench" class="anchor" href="#mug-development-workbench" aria-hidden="true"><span class="octicon octicon-link"></span></a>Mug development workbench</h1>

<p><img src="images/logo.png" alt="alt text" title="mug"></p>

<p>Mug helps you not to install your development workbench. It should always be easy as drinking from a mug ;)</p>

<p>It allows you to work in the same environment as it would be on the server in addition with development tools being run in Docker containers as well. You don't have to mess with /etc/hosts file because DNS is included and connected to service registry.</p>

<h1>
<a id="requirements" class="anchor" href="#requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Requirements</h1>

<ul>
<li>bash</li>
<li>curl</li>
<li>python</li>
<li>(optional) <a href="http://seges.github.io/cutlery">cutlery</a>
</li>
</ul>

<h1>
<a id="install" class="anchor" href="#install" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install</h1>

<pre><code>curl -L https://github.com/seges/mug/raw/master/setup.sh | sudo sh
</code></pre>

<p>strongly recommended but still optional, install Cutlery</p>

<pre><code>curl -L https://github.com/seges/cutlery/raw/master/setup.sh | sudo sh
</code></pre>

<h1>
<a id="example-usage" class="anchor" href="#example-usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example usage</h1>

<pre><code># prepare environment after start of your computer
mug docker-base restart wlan0

# fire your favorite IDE, e.g.
mug eclipse
# your /home/&lt;user&gt;/development is automatically mapped to /home/developer/development directory in the container

# change some files and try to build it
cd /home/&lt;user&gt;/development/my-project
mug

# here we are in 'mug'
&gt; cd my-project
# it executes mvn clean install
&gt; mvnci

</code></pre>

<h1>
<a id="run" class="anchor" href="#run" aria-hidden="true"><span class="octicon octicon-link"></span></a>Run</h1>

<p>Mug's main purpose is to support your whole development lifecycle and therefore there are multiple options what to work with:</p>

<ul>
<li>Setup phase - start default Docker containers supporting your runtime environment - ambassador, discovery, etc...</li>
<li>Development phase - jump to development environment and build, compile, etc...</li>
</ul>

<h2>
<a id="setup-phase" class="anchor" href="#setup-phase" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setup phase</h2>

<p>mug currently supports runtime environment (composition of your application containers, not composition of development containers) utilizing Consul and Ambassador. It is capable of preparing such environment as easy as:</p>

<pre><code>mug docker-base restart wlan0
</code></pre>

<p>which:</p>

<ul>
<li>sets global DNS for every following container to the one provided by Consul at Docker's bridge interface</li>
<li>starts <a href="https://github.com/progrium/ambassadord">Progrium's Ambassador</a>
</li>
<li>starts <a href="http://www.consul.io">Consul</a> with <a href="https://github.com/progrium/registrator">Registrator</a>
</li>
</ul>

<p>It utilizes <a href="http://seges.github.io/cutlery">Cutlery</a> project that contains basic scripts to work with such Docker environment.</p>

<h2>
<a id="development-phase" class="anchor" href="#development-phase" aria-hidden="true"><span class="octicon octicon-link"></span></a>Development phase</h2>

<h3>
<a id="existing-project" class="anchor" href="#existing-project" aria-hidden="true"><span class="octicon octicon-link"></span></a>Existing project</h3>

<pre><code>cd &lt;project_dir&gt;
mug
</code></pre>

<h3>
<a id="new-project" class="anchor" href="#new-project" aria-hidden="true"><span class="octicon octicon-link"></span></a>New project</h3>

<p>When you want to create a new project and you want to utilize the environment:</p>

<pre><code>cd &lt;workspace_dir&gt;
mug &lt;module&gt;
</code></pre>

<p>Where <strong>module</strong> is one of:</p>

<ul>
<li>backend-java</li>
<li>backend-scala</li>
<li>frontend-javascript</li>
</ul>

<h3>
<a id="configuration" class="anchor" href="#configuration" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configuration</h3>

<p>It is possible to define some project or workbench common parameters not included in the main code of mug to keep it reusable. You can create <strong>.mugrc</strong> file in your <strong>home</strong> directory or project workspace with following possible values:</p>

<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>mug_data</td>
<td>Specifies mug data container to be run for every mug execution if it is not already running. See <a href="#custom-projectworkbench-data">Custom project/workbench data</a>.</td>
</tr>
<tr>
<td>versions</td>
<td>Overrides default (latest) or unspecified versions of images resolved for particular module. It contains space delimited list of named image artifacts: /:. Example: <code>versions="seges/mug-backend-java:oracle-java7 seges/mug-backend-scala:2.11"</code>
</td>
</tr>
<tr>
<td>development_dir</td>
<td>Overrides default (/home/host_user/development) directory where workspace and source code is, so it is available to one of IDEs</td>
</tr>
<tr>
<td>idea_variant</td>
<td>Currently if set to "IU", it will use IntelliJ Idea Ultimate Trial. If not set, Community Edition will be used</td>
</tr>
</tbody>
</table>

<h4>
<a id="configuration-resolution" class="anchor" href="#configuration-resolution" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configuration resolution</h4>

<p>mug by default includes the configuration found in your home directory.</p>

<p>In case you have multiple project workspaces with different requirements, e.g. different setup of versions for development containers where projectA requires Java version7 but projectB requires version 8, then you can override it by putting additional <strong>.mugrc</strong> file somewhere up the tree from the current directory, where mug starts.</p>

<p>Advice: it is good to place one .mugrc in root directory of the workspace or set of projects if they are related</p>

<p>Example directory structure:</p>

<pre><code>/home/user
  |
  |- .mugrc
  |
  |- development
       |
       |- project A repo
       |    |
       |    |- .mugrc (this is project A specific and will be loaded on top of the home's one)
       |    |- projectA-api
       |    |- projectA-server
       |
       |- project B repo
            |
            |- .mugrc (this is project B specific and will be loaded on top of the home's one)
            |- projectB-common
            |- projectB-rest
</code></pre>

<h3>
<a id="custom-projectworkbench-data" class="anchor" href="#custom-projectworkbench-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Custom project/workbench data</h3>

<p>Imagine the situation you need to provide project or company specific data, e.g. default "settings.xml" in Maven repository or common configuration file for git. But such data is specific to the project or the company. In order not to modify the module image each time and have it generic, you should follow the Docker's pattern of data containers.</p>

<p>It is possible to add project or workbench specific data into the module image by providing additional Docker container with specific name <strong>mug-data</strong>. If such container exists, <em>mug</em> will include it as "volumes-from". If it is specified in the mug configuration parameter <strong>mug_data</strong>, it will be automatically started if it is not runnig.</p>

<p>There is a short-cut to run the data container manually for whatever reason:</p>

<pre><code>mug-data acme/mug-data
</code></pre>

<h3>
<a id="runtime-initialization" class="anchor" href="#runtime-initialization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Runtime initialization</h3>

<p>There is a possibility to initialize various aspects of the running environment, e.g. copying some workbench data upon start of the module container. It is strongly dependent on the module image implementation but images already implemented in mug have basic initialization routines.</p>

<p>Data that should be provided is usually contained either in:</p>

<ul>
<li>module image's directory</li>
<li>mug-data image</li>
</ul>

<p>If you want to know more about the support for initialization in provided modules, take a look in the appropriate documentation of the module. In case you want to utilize the support in mug, you have to:</p>

<ul>
<li>copy <code>entrypoint.sh</code> to your Docker context</li>
<li>create <code>docker-entrypoint.d</code> and include all initialization scripts inside</li>
<li>put following lines in Dockerfile:</li>
</ul>

<pre><code>ADD entrypoint.sh /home/developer/
ADD docker-entrypoint.d/ /docker-entrypoint.d/

CMD ["sudo", "/home/developer/entrypoint.sh"]
</code></pre>

<h2>
<a id="developer-tools" class="anchor" href="#developer-tools" aria-hidden="true"><span class="octicon octicon-link"></span></a>Developer tools</h2>

<p>Execute it via:
<code>mug &lt;tool command&gt;</code></p>

<h3>
<a id="ides" class="anchor" href="#ides" aria-hidden="true"><span class="octicon octicon-link"></span></a>IDEs</h3>

<p>Mug is capable of running your favourite IDEs:</p>

<table>
<thead>
<tr>
<th>Command</th>
<th>Tool name</th>
</tr>
</thead>
<tbody>
<tr>
<td>eclipse</td>
<td>Eclipse IDE - EE version</td>
</tr>
<tr>
<td>idea</td>
<td>IntelliJ Idea - by default Community Edition is run, see <em>idea_variant</em> configuration option</td>
</tr>
</tbody>
</table>

<p>connected to your local workspace. It mounts <code>/home/&lt;user&gt;/development</code> directory by default to the container's environment into <code>/home/developer/development</code>. It can be overriden by Mug configuration.</p>

<h3>
<a id="oracle" class="anchor" href="#oracle" aria-hidden="true"><span class="octicon octicon-link"></span></a>Oracle</h3>

<table>
<thead>
<tr>
<th>Command</th>
<th>Tool name</th>
</tr>
</thead>
<tbody>
<tr>
<td>oracle</td>
<td>Oracle XE database. Registered service <em>oracle-dev.service.consul</em>, 49161 port for DB connection. More on <a href="https://github.com/wnameless/docker-oracle-xe-11g">wnameless github</a>.</td>
</tr>
<tr>
<td>sqldeveloper</td>
<td>Oracle SQL Developer. More on <a href="https://registry.hub.docker.com/u/guywithnose/sqldeveloper">guywithnose Docker hub</a>
</td>
</tr>
</tbody>
</table>

<h1>
<a id="helpers" class="anchor" href="#helpers" aria-hidden="true"><span class="octicon octicon-link"></span></a>Helpers</h1>

<h2>
<a id="discovery" class="anchor" href="#discovery" aria-hidden="true"><span class="octicon octicon-link"></span></a>Discovery</h2>

<p>Open the UI for service discovery</p>

<pre><code>mug discovery
</code></pre>

<h2>
<a id="docker" class="anchor" href="#docker" aria-hidden="true"><span class="octicon octicon-link"></span></a>Docker</h2>

<table>
<thead>
<tr>
<th>Action</th>
<th>Command</th>
</tr>
</thead>
<tbody>
<tr>
<td>Clean stale images</td>
<td><code>mug clean images</code></td>
</tr>
<tr>
<td>Clean stale containers</td>
<td><code>mug clean ps</code></td>
</tr>
</tbody>
</table>

<h1>
<a id="modules" class="anchor" href="#modules" aria-hidden="true"><span class="octicon octicon-link"></span></a>Modules</h1>

<h2>
<a id="backend-java" class="anchor" href="#backend-java" aria-hidden="true"><span class="octicon octicon-link"></span></a>backend-java</h2>

<p>Copies /home/developer/home-init.d into /home/developer and /home/developer/.m2.tmpl into /home/developer/.m2/repository</p>

<h2>
<a id="backend-scala" class="anchor" href="#backend-scala" aria-hidden="true"><span class="octicon octicon-link"></span></a>backend-scala</h2>

<p>Copies ivy cached dependencies</p>

<h2>
<a id="frontend-javascript" class="anchor" href="#frontend-javascript" aria-hidden="true"><span class="octicon octicon-link"></span></a>frontend-javascript</h2>

<h1>
<a id="development" class="anchor" href="#development" aria-hidden="true"><span class="octicon octicon-link"></span></a>Development</h1>

<ul>
<li>implement a Docker image inside "docker" directory</li>
<li>extend <code>bin/mug</code> script in order to properly identify the project</li>
<li>add initialization scripts in /docker-entrypoint.d using ADD or COPY
** use <code>entrypoint.sh</code> as your main command</li>
</ul>

<p>Use <code>docker-build.sh</code> and <code>docker-push.sh</code> commands to prepare images.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Mug maintained by <a href="https://github.com/seges">seges</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-569687-27");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
